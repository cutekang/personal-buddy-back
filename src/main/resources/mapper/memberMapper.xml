<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.app.personalbuddyback.mapper.MemberMapper">

<!-- 회원가입 -->
    <insert id="insert" parameterType="MemberVO">
        INSERT INTO TBL_MEMBER
        VALUES(SEQ_MEMBER.NEXTVAL, #{memberEmail}, #{memberPassword}, #{memberName}, #{memberBirth},
               #{memberGender}, #{memberPhone}, #{memberNickName}, #{memberStatusMessage}, #{memberImgName},
               #{memberImgPath}, #{memberPoint}, #{memberAdmin}, #{memberCreateDate}, #{memberTermServiceAgree},
               #{memberTermInformationAgree}, #{memberTermLocationAgree}, #{memberTermPromotionAgree})
    </insert>

<!-- 이메일 중복 체크 -->
    <select id="selectCountIdByEmail" parameterType="String" resultType="_int">
        SELECT COUNT(ID)
        FROM TBL_MEMBER
        WHERE MEMBER_EMAIL = #{memberEmail}
    </select>

<!-- 전화번호 중복 체크 -->
    <select id="selectCountIdByPhone" parameterType="String" resultType="_int">
        SELECT COUNT(ID)
        FROM TBL_MEMBER
        WHERE MEMBER_PHONE = #{memberPhone}
    </select>

<!-- 닉네임 중복 체크 -->
    <select id="selectCountIdByNickName" parameterType="String" resultType="_int">
        SELECT COUNT(ID)
        FROM TBL_MEMBER
        WHERE MEMBER_NICKNAME = #{memberNickName}
    </select>

<!-- 로그인 -->
    <select id="selectOne" parameterType="MemberVO" resultType="Long">
        SELECT ID
        FROM TBL_MEMBER
        WHERE MEMBER_EMAIL = #{memberEmail} AND MEMBER_PASSWORD = #{memberPassword}
    </select>

<!-- 이메일 찾기 -->
    <select id="selectEmailByPhone" parameterType="String" resultType="String">
        SELECT MEMBER_EMAIL
        FROM TBL_MEMBER
        WHERE MEMBER_PHONE = #{memberPhone}
    </select>

<!-- 비밀번호 찾기 -->
    <select id="selectMemberByNameAndEmail" parameterType="MemberVO" resultType="Long">
        SELECT ID
        FROM TBL_MEMBER
        WHERE MEMBER_NAME = #{memberName} AND MEMBER_EMAIL = #{memberEmail}
    </select>

<!-- 비밀번호 변경 -->
    <update id="updatePassword" parameterType="MemberVO">
        UPDATE TBL_MEMBER
        SET MEMBER_PASSWORD = #{memberPassword}
        WHERE ID = #{id}
    </update>

</mapper>